{"ast":null,"code":"var _jsxFileName = \"/Users/real/Desktop/last \\u0E1E\\u0E23\\u0E35\\u0E23\\u0E2D\\u0E1A5/give-for-child/src/backoffice/BookingBack.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Table, Form, Col, FormControl, Button, Card, Modal, Row } from 'react-bootstrap';\nimport { BsTrash } from 'react-icons/bs';\nimport './css/ActivityBack.css';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst DateThai = date => {\n  return date.toLocaleDateString('th-TH', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  });\n};\n\n_c = DateThai;\nvar setTimeOut;\n\nconst BookingBack = () => {\n  _s();\n\n  const [rowData, setRowData] = useState([]);\n  useEffect(() => {\n    updateRows();\n  }, []);\n\n  const BookingSuccess = async id => {\n    axios.put(`/booking/success/${id}`).then(res => {\n      if (res.status == 200) {\n        updateRows();\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const [showSlip, setShowSlip] = useState(false);\n  const [imgSilp, setImgSilp] = useState(null);\n\n  const onClickSlipShow = () => setShowSlip(true);\n\n  const onClickSlipClose = () => setShowSlip(false);\n\n  const setRow = data => {\n    // ใส่ชื่อ column ทั้งหมดตาม table\n    return /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.booking_id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.booking_name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.member_name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.tel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: DateThai(new Date(data.date))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.slip ? /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: () => {\n            onClickSlipShow();\n            setImgSilp(data.slip);\n          },\n          children: \"\\u0E14\\u0E39 Slip\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 31\n        }, this) : ''\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: data.is_success ? /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"success\",\n          disabled: true,\n          children: \"\\u0E40\\u0E23\\u0E35\\u0E22\\u0E1A\\u0E23\\u0E49\\u0E2D\\u0E22\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"warning\",\n          onClick: () => {\n            BookingSuccess(data.booking_id);\n          },\n          children: \"\\u0E23\\u0E2D\\u0E14\\u0E33\\u0E40\\u0E19\\u0E34\\u0E19\\u0E01\\u0E32\\u0E23\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"buttonD\",\n          onClick: () => {\n            confirm(() => {\n              cancelBooking(data.id);\n            });\n          },\n          variant: \"danger\",\n          children: /*#__PURE__*/_jsxDEV(BsTrash, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this);\n  };\n\n  const [search, setSearch] = useState('');\n  useEffect(() => {\n    clearTimeout(setTimeOut);\n    setTimeOut = setTimeout(() => {\n      updateRows(search ? search : '');\n    }, 500);\n  }, [search]);\n\n  const updateRows = async () => {\n    let data = {\n      foundation: localStorage.getItem('foundation'),\n      search: search\n    };\n    axios.post(`/booking/foundation/`, data).then(res => {\n      if (res.data) {\n        setRowData(res.data.map(v => setRow(v)));\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const confirm = methed => {\n    Swal.fire({\n      title: 'ยืนยัน',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#0062cc',\n      cancelButtonColor: '#ccc',\n      confirmButtonText: 'ลบ',\n      cancelButtonText: 'ยกเลิก'\n    }).then(result => {\n      if (result.isConfirmed) {\n        methed();\n      }\n    });\n  };\n\n  const cancelBooking = async id => {\n    await axios.delete(`/booking/${id}/`).then(res => {\n      Swal.fire({\n        title: 'Deleted!',\n        text: 'Your file has been deleted.',\n        icon: 'success',\n        confirmButtonColor: 'Green',\n        confirmButtonText: 'Ok'\n      }).then(result => {\n        if (result.isConfirmed) {\n          window.location.reload();\n        }\n      });\n    });\n  };\n\n  const sendMail = () => {\n    axios.get(`/booking/sendmail`).then(res => {\n      Swal.fire({\n        title: 'ส่ง Email เรียบร้อย',\n        icon: 'success',\n        confirmButtonColor: 'Green',\n        confirmButtonText: 'ตกลง'\n      }).then(result => {});\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"all-font\",\n    style: {\n      width: 'calc(100%-300px;)',\n      height: '100vh',\n      overflow: 'scroll'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '3rem'\n      },\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        style: {\n          padding: '1.5rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n          children: \"\\u0E01\\u0E32\\u0E23\\u0E08\\u0E2D\\u0E07\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            col: 6,\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              inline: true,\n              children: /*#__PURE__*/_jsxDEV(FormControl, {\n                type: \"text\",\n                placeholder: \"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E1C\\u0E39\\u0E49\\u0E40\\u0E02\\u0E49\\u0E32\\u0E23\\u0E48\\u0E27\\u0E21\",\n                className: \" mr-sm-2\",\n                style: {\n                  marginTop: '1.5%'\n                },\n                onChange: e => setSearch(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            col: 6,\n            inline: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              style: {\n                float: 'right',\n                width: 250\n              },\n              onClick: sendMail,\n              children: \"\\u0E2A\\u0E48\\u0E07 Email \\u0E41\\u0E08\\u0E49\\u0E07\\u0E40\\u0E15\\u0E37\\u0E2D\\u0E19\\u0E2A\\u0E33\\u0E2B\\u0E23\\u0E31\\u0E1A\\u0E27\\u0E31\\u0E19\\u0E19\\u0E35\\u0E49\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Table, {\n          striped: true,\n          hover: true,\n          style: {\n            marginTop: '1.5%'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E19\\u0E34\\u0E18\\u0E34\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E1C\\u0E39\\u0E49\\u0E08\\u0E2D\\u0E07\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\\u0E17\\u0E4C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E08\\u0E2D\\u0E07\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0E15\\u0E31\\u0E27\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: rowData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: showSlip,\n      onHide: onClickSlipClose,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"img_slip\",\n          style: {\n            backgroundImage: `url(../resources/uploads/${imgSilp})`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 9\n  }, this);\n};\n\n_s(BookingBack, \"/haStnriG0xlupOUgzYYiaL7/Mw=\");\n\n_c2 = BookingBack;\nexport default BookingBack;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"DateThai\");\n$RefreshReg$(_c2, \"BookingBack\");","map":{"version":3,"sources":["/Users/real/Desktop/last พรีรอบ5/give-for-child/src/backoffice/BookingBack.js"],"names":["React","useState","useEffect","Component","Link","Table","Form","Col","FormControl","Button","Card","Modal","Row","BsTrash","axios","Swal","DateThai","date","toLocaleDateString","year","month","day","setTimeOut","BookingBack","rowData","setRowData","updateRows","BookingSuccess","id","put","then","res","status","catch","err","console","log","showSlip","setShowSlip","imgSilp","setImgSilp","onClickSlipShow","onClickSlipClose","setRow","data","booking_id","booking_name","member_name","tel","Date","slip","is_success","confirm","cancelBooking","search","setSearch","clearTimeout","setTimeout","foundation","localStorage","getItem","post","map","v","methed","fire","title","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","isConfirmed","delete","text","window","location","reload","sendMail","get","width","height","overflow","padding","marginTop","e","target","value","float","backgroundImage"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Table, Form, Col, FormControl, Button, Card, Modal, Row } from 'react-bootstrap';\nimport { BsTrash } from 'react-icons/bs';\nimport './css/ActivityBack.css';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\n\n\n\nconst DateThai = (date) => {\n    return date.toLocaleDateString('th-TH', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n    });\n};\n\nvar setTimeOut;\nconst BookingBack = () => {\n    const [rowData, setRowData] = useState([]);\n    useEffect(() => {\n        updateRows();\n    }, []);\n\n    const BookingSuccess = async (id) => {\n        axios\n            .put(`/booking/success/${id}`)\n            .then((res) => {\n                if (res.status == 200) {\n                    updateRows();\n                }\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    };\n\n    const [showSlip, setShowSlip] = useState(false);\n    const [imgSilp, setImgSilp] = useState(null);\n    \n    const onClickSlipShow = () => setShowSlip(true);\n    const onClickSlipClose = () => setShowSlip(false);\n\n    const setRow = (data) => {\n        // ใส่ชื่อ column ทั้งหมดตาม table\n        return (\n            <tr>\n                <td>{data.booking_id}</td>\n                <td>{data.booking_name}</td>\n                <td>{data.member_name}</td>\n                <td>{data.tel}</td>\n            \n                <td>{DateThai(new Date(data.date))}</td>\n                <td>\n                {data.slip ? (<Button variant='primary' onClick={() => {onClickSlipShow(); setImgSilp(data.slip)}}>\n                            ดู Slip\n                        </Button>) : ''}\n                </td>\n                <td>\n                    {data.is_success ? (\n                        <Button variant='success' disabled>\n                            เรียบร้อย\n                        </Button>\n                    ) : (\n                        <Button\n                            variant='warning'\n                            onClick={() => {\n                                BookingSuccess(data.booking_id);\n                            }}\n                        >\n                            รอดำเนินการ\n                        </Button>\n                    )}\n                </td>\n                <td>\n                    <Button \n                    className='buttonD'\n                        onClick={() => {\n                            confirm(()=> {cancelBooking(data.id);})\n                        }}\n                        variant='danger'\n                    >\n                        <BsTrash/>\n                    </Button>\n                </td>\n            </tr>\n        );\n    };\n\n    const [search, setSearch] = useState('');\n    useEffect(() => {\n        clearTimeout(setTimeOut);\n\n        setTimeOut = setTimeout(() => {\n            updateRows(search ? search : '');\n        }, 500);\n    }, [search]);\n\n    const updateRows = async () => {\n        let data = {\n            foundation: localStorage.getItem('foundation'),\n            search: search\n        }\n        axios\n            .post(`/booking/foundation/`,data)\n            .then((res) => {\n                if (res.data) {\n                    setRowData(res.data.map((v) => setRow(v)));\n                }\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    };\n    \n    const confirm = (methed) => {\n        Swal.fire({\n            title: 'ยืนยัน',\n            icon: 'warning',\n            showCancelButton: true,\n            confirmButtonColor: '#0062cc',\n            cancelButtonColor: '#ccc',\n            confirmButtonText: 'ลบ',\n            cancelButtonText: 'ยกเลิก'\n        }).then((result) => {\n            if (result.isConfirmed) {\n                methed();\n            }\n        });\n    };\n\n    const cancelBooking = async (id) => {\n        await axios.delete(`/booking/${id}/`).then((res) => {\n            Swal.fire({\n                title: 'Deleted!',\n                text: 'Your file has been deleted.',\n                icon: 'success',\n                confirmButtonColor: 'Green',\n                confirmButtonText: 'Ok',\n            }).then((result) => {\n                if (result.isConfirmed) {\n                    window.location.reload();\n                }\n            });\n        });\n    }\n    \n    \n    \n    const sendMail = () => {\n        axios.get(`/booking/sendmail`).then((res) => {\n            Swal.fire({\n                title: 'ส่ง Email เรียบร้อย',\n                icon: 'success',\n                confirmButtonColor: 'Green',\n                confirmButtonText: 'ตกลง',\n            }).then((result) => {\n                \n            });\n        });\n    }\n    \n\n    return (\n        <div\n            className='all-font'\n            style={{\n                width: 'calc(100%-300px;)',\n                height: '100vh',\n                overflow: 'scroll',\n            }}\n        >\n            <div style={{ padding: '3rem' }}>\n                <Card style={{ padding: '1.5rem' }}>\n                    <Card.Title>การจอง</Card.Title>\n                    <Row>\n                        <Col col={6}>\n                            <Form inline>\n                                <FormControl\n                                    type='text'\n                                    placeholder='ค้นหาชื่อผู้เข้าร่วม'\n                                    className=' mr-sm-2'\n                                    style={{ marginTop: '1.5%' }}\n                                    onChange={(e) => setSearch(e.target.value)}\n                                />\n                                {}\n                            </Form>\n                        </Col>\n                        <Col col={6} inline>\n                            <Button style={{float:'right',width:250}} onClick={sendMail}>ส่ง Email แจ้งเตือนสำหรับวันนี้</Button>\n                        </Col>\n                    </Row>\n                    <Table striped hover style={{ marginTop: '1.5%' }}>\n                        <thead>\n                            <tr>\n                                <th>ID</th>\n                                <th>ชื่อมูลนิธิ</th>\n                                <th>ชื่อผู้จอง</th>\n                                <th>เบอร์โทรศัพท์</th>\n                                \n                                <th>วันที่จอง</th>\n                          \n                                <th>ตัวเลือก</th>\n                                <th></th>\n                            </tr>\n                        </thead>\n                        <tbody>{rowData}</tbody>\n                    </Table>\n                </Card>\n            </div>\n            <Modal show={showSlip} onHide={onClickSlipClose}>\n                <Modal.Header closeButton>\n                    {/* <Modal.Title>เพิ่ม</Modal.Title> */}\n                </Modal.Header>\n                <Modal.Body>\n                    <div className=\"img_slip\" style={{backgroundImage: `url(../resources/uploads/${imgSilp})`}}></div>\n                </Modal.Body>\n            </Modal>\n        </div>\n    );\n};\n\nexport default BookingBack;\n"]},"metadata":{},"sourceType":"module"}