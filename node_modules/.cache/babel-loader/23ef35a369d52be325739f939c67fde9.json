{"ast":null,"code":"var _jsxFileName = \"/Users/real/Desktop/last \\u0E1E\\u0E23\\u0E35\\u0E23\\u0E2D\\u0E1A5/give-for-child/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { LineLogin } from 'reactjs-line-login';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport 'reactjs-line-login/dist/index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Login() {\n  _s();\n\n  const history = useHistory();\n  const [payload, setPayload] = useState(null);\n  const [idToken, setIdToken] = useState(null);\n  const LINE_LOGIN_CHANNEL_ID = 1655298880;\n  const LINE_LOGIN_CHANNEL_SECRET = '055d4867b89e964d48dc1874c2da427f';\n  const LINE_LOGIN_CALLBACK_URL = 'http://localhost:3000/login'; // const LINE_LOGIN_CALLBACK_URL = 'https://give-for-child.thesis-su2020ict.com/login';\n\n  function onGetAccount(account) {\n    if (!account.sub || !account.picture || !account.name) return;\n    const data = {\n      sub_line_id: account.sub,\n      img: account.picture,\n      name: account.name,\n      email: account.email\n    };\n    Login(data);\n  }\n\n  async function Login(data) {\n    try {\n      axios.post('/login', data).then(res => {\n        localStorage.setItem('imgProfile', data.img);\n        localStorage.setItem('id', res.data.id);\n        localStorage.setItem('name', res.data.name);\n        localStorage.setItem('img', res.data.img);\n        Swal.fire('', 'ยินดีต้อนรับ', 'success');\n      }).catch(err => {\n        Swal.fire('', 'ไม่สามารถเข้าสู่ระบบได้', 'error');\n      });\n    } catch (err) {\n      console.log(err);\n\n      if (err.response.status === 500) {\n        console.log(err.response);\n      } else {\n        console.log('unknow');\n      }\n    }\n\n    setTimeout(() => {\n      history.push('/');\n    }, 1000);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(LineLogin, {\n      clientID: LINE_LOGIN_CHANNEL_ID,\n      clientSecret: LINE_LOGIN_CHANNEL_SECRET,\n      state: \"b41c8fd15b895f0fc28bfwb9d7da89054d931e7s\",\n      nonce: \"d78a51235f6ee189e831q9c68523cfa336917ada\",\n      redirectURI: LINE_LOGIN_CALLBACK_URL,\n      scope: \"profile openid email\",\n      setPayload: setPayload,\n      setIdToken: setIdToken\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this), payload && idToken ? onGetAccount(idToken) :\n    /*#__PURE__*/\n    // console.log(\"payload\", payload, \"idToken\", idToken)\n    _jsxDEV(_Fragment, {}, void 0, false)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"GFzdKNnLVdouE/nLUGK+Xta1uPc=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/real/Desktop/last พรีรอบ5/give-for-child/src/pages/Login.js"],"names":["React","useState","useEffect","useHistory","LineLogin","axios","Swal","Login","history","payload","setPayload","idToken","setIdToken","LINE_LOGIN_CHANNEL_ID","LINE_LOGIN_CHANNEL_SECRET","LINE_LOGIN_CALLBACK_URL","onGetAccount","account","sub","picture","name","data","sub_line_id","img","email","post","then","res","localStorage","setItem","id","fire","catch","err","console","log","response","status","setTimeout","push"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { LineLogin } from 'reactjs-line-login';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport 'reactjs-line-login/dist/index.css';\n\nfunction Login() {\n    \n    const history = useHistory();\n\n    const [payload, setPayload] = useState(null);\n    const [idToken, setIdToken] = useState(null);\n\n    const LINE_LOGIN_CHANNEL_ID = 1655298880;\n    const LINE_LOGIN_CHANNEL_SECRET = '055d4867b89e964d48dc1874c2da427f';\n    const LINE_LOGIN_CALLBACK_URL = 'http://localhost:3000/login';\n    // const LINE_LOGIN_CALLBACK_URL = 'https://give-for-child.thesis-su2020ict.com/login';\n\n    function onGetAccount(account) {\n        if (!account.sub || !account.picture || !account.name) return;\n\n        const data = {\n            sub_line_id: account.sub,\n            img: account.picture,\n            name: account.name,\n            email: account.email,\n        };\n        Login(data);\n    }\n\n    async function Login(data) {\n        try {\n            axios\n                .post('/login', data)\n                .then((res) => {\n                    localStorage.setItem('imgProfile', data.img);\n                    localStorage.setItem('id', res.data.id);\n                    localStorage.setItem('name', res.data.name);\n                    localStorage.setItem('img', res.data.img);\n                    Swal.fire('', 'ยินดีต้อนรับ', 'success');\n                })\n                .catch((err) => {\n                    Swal.fire('', 'ไม่สามารถเข้าสู่ระบบได้', 'error');\n                });\n        } catch (err) {\n            console.log(err);\n            if (err.response.status === 500) {\n                console.log(err.response);\n            } else {\n                console.log('unknow');\n            }\n        }\n        setTimeout(() => {\n            history.push('/');\n        }, 1000);\n    }\n\n    return (\n        <div>\n            <LineLogin\n                clientID={LINE_LOGIN_CHANNEL_ID}\n                clientSecret={LINE_LOGIN_CHANNEL_SECRET}\n                state='b41c8fd15b895f0fc28bfwb9d7da89054d931e7s'\n                nonce='d78a51235f6ee189e831q9c68523cfa336917ada'\n                redirectURI={LINE_LOGIN_CALLBACK_URL}\n                scope='profile openid email'\n                setPayload={setPayload}\n                setIdToken={setIdToken}\n            />\n            {payload && idToken ? (\n                onGetAccount(idToken)\n            ) : (\n                // console.log(\"payload\", payload, \"idToken\", idToken)\n                <></>\n            )}\n        </div>\n    );\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}